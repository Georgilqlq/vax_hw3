<!DOCTYPE html>

<html>

<head>
    <title>moving camera hw
    </title>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    <script src="three.min.js"></script>
    <script src="stats.min.js"></script>
    <script src="WebGL.js"></script>
    <script src="vax.js"></script>
</head>

<body>
    <script>
        vaxInit();
        var top_bot = new THREE.Group();
        var geometry = new THREE.PlaneGeometry(30, 30);
        var material = new THREE.MeshBasicMaterial({ color: 0x00ff00, side: THREE.DoubleSide });
        var plane = new THREE.Mesh(geometry, material);
        plane.rotation.set(Math.PI / 2, 0, 0);
        plane.position.set(0, -15, 0);
        top_bot.add(plane);

        var top_plane = plane.clone();
        top_plane.position.set(0, 15, 0);
        top_plane.rotation.set(-Math.PI / 2, 0, 0);
        top_bot.add(top_plane);
        scene.add(top_bot);

        var left_right = top_bot.clone();
        left_right.rotation.set(0, 0, Math.PI / 2);
        scene.add(left_right);

        var front_back = top_bot.clone();
        front_back.rotation.set(Math.PI / 2, 0, 0);
        scene.add(front_back);

        geometry = new THREE.CylinderGeometry(0, 2, 5, 35);
        material = new THREE.MeshBasicMaterial({ color: 0xffff00 });
        var pointy = new THREE.Mesh(geometry, material);
        // pointy.position.set(0, 0, -10);
        // scene.add(pointy);

        var colors = ['black', 'red', 'magenta', 'orange', 'cyan', 'blue', 'yellow', 'purple', 'pink', 'white'];
        for (var i = 0; i < 10; i++) {
            var side1 = new THREE.Mesh(new THREE.CylinderGeometry(0, 2, 5, 35), new THREE.MeshBasicMaterial());
            var side2 = pointy.clone();
            var side3 = pointy.clone();
            var side4 = pointy.clone();
            var side5 = pointy.clone();
            var side6 = pointy.clone();

            side1.material.color.set(colors[Math.floor(Math.random() * 10)]);
            side2.material.color.set(colors[Math.floor(Math.random() * 10)]);
            side3.material.color.set(colors[Math.floor(Math.random() * 10)]);
            side4.material.color.set(colors[Math.floor(Math.random() * 10)]);
            side5.material.color.set(colors[Math.floor(Math.random() * 10)]);
            side6.material.color.set(colors[Math.floor(Math.random() * 10)]);


            side1.position.set(14, Math.floor(Math.random() * 28 - 14), Math.floor(Math.random() * 28 - 14));
            side2.position.set(-14, Math.floor(Math.random() * 28 - 14), Math.floor(Math.random() * 28 - 14));
            side3.position.set(Math.floor(Math.random() * 28 - 14), Math.floor(Math.random() * 28 - 14), 14);
            side4.position.set(Math.floor(Math.random() * 28 - 14), Math.floor(Math.random() * 28 - 14), -14);
            side5.position.set(Math.floor(Math.random() * 28 - 14), 14, Math.floor(Math.random() * 28 - 14));
            side6.position.set(Math.floor(Math.random() * 28 - 14), -14, Math.floor(Math.random() * 28 - 14));

            scene.add(side1, side2, side3, side4, side5, side6);

        }

        camera.position.set(0, 0, 0);
        camera.lookAt(new THREE.Vector3(0, 0, 0));


        window.addEventListener("deviceorientation", handleOrientation, true);
        var alpha_prev, beta_prev, gamma_prev;
        var flipped = false;
        function handleOrientation(event) {
            var absolute = event.absolute;
            var alpha = event.alpha;
            var beta = event.beta;
            var gamma;
            if (event.gamma < 0 && event.gamma > -90) {
                gamma = event.gamma + 90;
            }
            else {
                gamma = event.gamma - 90;
            }
            // var gamma;
            // if (event.gamma < 90 && event.gamma > -90) {
            // gamma = event.gamma + 90;
            // }
            // else {
            //     gamma = (scene.rotation.x / Math.PI * 180) + 1;
            // }
            console.log(event.gamma);
            // console.log(event.beta);
            // console.log(event.gamma);
            // console.log(pointer.position.x);
            // console.log(pointer.position.y);
            // scene.rotation.x += event.gamma / 200;
            // scene.rotation.y -= event.beta / 150;

            // if (gamma_prev > gamma) {
            //     scene.rotation.x += 0.1;
            // }
            // else if (gamma_prev < gamma) {
            //     scene.rotation.x -= 0.1;
            // }

            // var gammaRotation = event.gamma ? event.gamma * (Math.PI / 180) : 0;
            // scene.rotation.x = gammaRotation;
            // var betaRotation = event.beta ? event.beta * (Math.PI / 180) : 0;
            // scene.rotation.y = betaRotation;
            // if (gamma < 0) {
            //     scene.rotation.x = scene.rotation.x - gamma;
            // }
            // else {
            // }




            scene.rotation.y = -alpha * Math.PI / 180;
            scene.rotation.x = gamma * Math.PI / 180;


            // if( scene.rotation.x )

            alpha_prev = alpha;
            beta_prev = beta;
            gamma_prev = gamma;

        }


        function animate() {
            // plane.rotation.set(t, t / 2, t / 3);
            // scene.rotation.set(0, t, 0);
        }
    </script>
</body>

</html>